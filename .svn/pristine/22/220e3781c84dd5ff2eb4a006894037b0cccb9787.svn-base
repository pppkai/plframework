/**
 +------------------------------------------------------------------------------
 * functions.php 函数功能及调用说明文档
 +------------------------------------------------------------------------------
 * @author   谭双艳<g_0445@163.com> 
 * @update   2010-10-19
 * @version   v0.1
 +------------------------------------------------------------------------------
 */

1．halt($error) 
功能：错误输出，在调试模式下面会输出详细的错误信息，否则就定向到指定的错误页面。
参数：$error是错误信息，可以为异常类PLFException格式的数组或字符串。
如：halt("参数错误")。
---------------------------------------------------------------------------------------------------------------------

2．redirect($url, $time = 0, $msg = '') 
功能：URL重定向；
参数：$url: 要定向的URL地址；$time: 定向的延迟时间，单位为秒；$msg:提示信息。
如：redirect(‘index.php’,10,’操作成功’);表示提示“操作成功”并在10秒后跳转到index.php页面。如果$msg为空，则提示“系统将在10秒之后自动跳转到index.php”。
---------------------------------------------------------------------------------------------------------------------

3．dump($var = '', $echo = true, $label = null, $strict = true) 
功能：输出变量；
参数：$var:变量名；$echo:是否输出，不输出则返回；$label:标签，比如<a>,<img>;$strick:是否显示输出变量的字符长度。
如：
$aa = "abcd";
echo dump($aa, false, "<img src='aa.jpg'>", true);
或：
$aa = "abcd";
dump($aa, true, "<img src='aa.jpg'>", true); 结果都是显示图片aa.jpg和string(4) "abcd"
----------------------------------------------------------------------------------------------------------------------

4．get_instance($className = '', $method = '', $args = array())
功能：创建类的实例，并支持调用实例的函数。
参数：$className:类名；$method：函数名；$args：函数中的参数列表。
如：
Admin.class.php:
Class Admin
{
    function show($var)
    {
    	echo $var;
    }
}
Test.php:
$arr = array("hello");
$ad = get_instance('Admin', 'show', $arr); 表示创建Admin的实例并调用它的show函数，结果输出：hello。
-------------------------------------------------------------------------------------------------------------------

5．get_runtime($time)
功能：获取运行时间差（秒）；
参数：$time：开始时间，可以是数字也可以是数组，如果传入数组得到的就是前面两个元素arr[0]和arr[1]的时间差，如果传入一个数字或字符，得到的是这个数字和microtime(TRUE) 当前 Unix 时间戳的时间差，小数点保留4位。
-----------------------------------------------------------------------------------------------------------------

6．auto_charset($fContents, $from = '', $to = '')
功能：自动转换字符集 支持数组转换。
参数：$fContents:需要转换的字符串；$from:模板字符集；$to：输出字符集。
如：auto_charset('我是中国人', 'UTF8', 'gb2312');
---------------------------------------------------------------------------------------------------------------

7. pathAnaly($class, $baseUrl = '', $ext = '.class.php')
功能：类文件路径解析。
参数：$class:类路径；$baseUrl:路径前缀；$ext:类文件后缀；返回类文件的完整路径。
如：echo pathAnaly('User', '../'); 结果输出：../User.class.php。
----------------------------------------------------------------------------------------------------------------

8．import($class, $baseUrl = '', $ext = '.class.php')：
功能：导入所需的类库 类同java的Import。
参数：$class:类路径；$baseUrl:路径前缀；$ext:类文件后缀；
----------------------------------------------------------------------------------------------------------------

9．throw_exception($msg, $type = 'PLFException', $code = 0)
功能：自定义异常处理。
参数：$msg:错误信息；$type:错误类型，默认为PLFException, 如果指定的异常类不存在，则直接输出错误信息. $code：错误码
如：
if ($sql  ==  false || empty($sql)) 
{
    throw_exception(L("_SQL_ISEMPTY_ERROR_"));
    return false;
}
----------------------------------------------------------------------------------------------------------------

10. to_guid_string($mix)
功能：根据PHP各种类型变量生成唯一标识号。
参数：$mix为变量。
如：
$arr = array("hello");
echo to_guid_string($arr); 
结果输出：f1f217c773837642968ce6e3aea4ed41
-----------------------------------------------------------------------------------------------------------------

11. get_iterator($values)
功能：获得迭代因子 使用foreach遍历对象，递归获取一个数组的元素，将其变成某个对象的因子，其对应规则就是数组本身的规则。
参数：$value:数组。
如：$a  =  array('left' =>'123', 'right' =>array('one' =>'1', 'thd' =>'3'));
$aa  =  get_iterator($a);
echo $aa->offsetGet('left');        //输出:123
$aa->offsetSet('left','ssss');       //设置left属性的值为ssss
echo $aa->offsetGet('left');          //输出：ssss
$c = $aa->offsetGet('right');           //得到$c数组对象
echo $c['one'];                       //输出$c的第一个元素：1
-------------------------------------------------------------------------------------------------------------------

12．is_instance_of($object, $className)
功能：判断$object是否为$className的实例对象。也就是对关键字instanceof的封装。
参数：$object:一个实例对象，$className:一个类名。
如：class Student
{
	private $id;
	private $name;
	private $sex;
}

$stu = new Student();
if (is_instance_of($stu, 'Student')) echo 'he is a student'; 结果输出：he is a student 
-------------------------------------------------------------------------------------------------------------------

13. msubstr($str, $start = 0, $length = 0, $suffix = false, $charset = 'utf-8')
功能：字符串截取，支持中文和其他编码。
参数：$str: 需要转换的字符串;$start:开始位置；$length:截取长度；$suffix: 是否用…替换截断字符；$charset：编码方式。
如：
$str = 'hello world,中国';
echo msubstr($str, 0, 10);  结果输出：hello worl
-------------------------------------------------------------------------------------------------------------------

14. rand_string($len = 6, $type = '', $addChars = '')
功能：产生随机字串，可用来自动生成密码 默认长度6位 字母和数字混合。
参数：$len:字符串长度；$type:字串类型，0 字母 1 数字 其它 混合；$addChars: 额外字符
如：echo rand_string(); 结果输出6位随即字串。
---------------------------------------------------------------------------------------------------------------------

15. build_verify($length = 4, $mode = 1)
功能：获取登录验证码 默认为4位数字
参数：$length:验证码长度；$mode:模式, 0 字母 1 数字 2 大写+其它 3小写+其它 4中文+其它 混合。
如：build_verify(); 结果输出：4为随机数字。
----------------------------------------------------------------------------------------------------------------------

16．createAppDir()
功能：创建项目基础目录结构。
----------------------------------------------------------------------------------------------------------------------

17. stripslashes_deep($value)
功能：stripslashes扩展 可用于数组，stripslashes()是系统函数，去掉反斜杠\.
参数：$value:字符串或数组
---------------------------------------------------------------------------------------------------------------------

18. trim_deep($value)
功能：trim扩展，可用于数组，trim()是系统函数，去掉字符串中的空格。
参数：$value:字符串或数组。
---------------------------------------------------------------------------------------------------------------------

19. L($name = '', $value = null) 
功能：获取/设置语言定义
参数：$name:变量；$value：变量值
如：echo L($str, '中国');  结果输出：中国
---------------------------------------------------------------------------------------------------------------------

20. R($name = '')
功能：替换$_REQUEST,接受request请求数据。$name为参数名。
 --------------------------------------------------------------------------------------------------------------------

21. P($name = '')
功能：替换$_POST,接受post数据。$name为参数名。
-------------------------------------------------------------------------------------------------------------------

22. G($name = '')
功能：替换$_GET,接受get数据。$name为参数名。
--------------------------------------------------------------------------------------------------------------------

23. S($name = '', $value = null)
功能：替换$_Session,可以读写Session值。
参数：$name:Session键；$value:Session值。
--------------------------------------------------------------------------------------------------------------------

24. C($name = '', $value = null)
功能：设置或获取环境配置值。
参数：$name:变量；$value:变量值。
--------------------------------------------------------------------------------------------------------------------

25．F($name, $value = '', $expire = -1, $path = '')
功能：快速PHP文件数据读取和保存，针对简单类型数据 字符串、数组。
参数：$name:变量；$value:变量值；$expire:生命周期；$path:路径。
如：F('a.php', '123456123', $expire = -1, $path = '../'); 结果：在xywz目录下新建了一个a.php文件，内容是123456123
---------------------------------------------------------------------------------------------------------------------

26. isAjax()
功能：是否ajax提交。
---------------------------------------------------------------------------------------------------------------------

27．isMemCache() 
功能：主要是判断当前的PHP环境下面有没有安装Memcache模块，也是就是判断Memcache可不可用。MemCache是php的一个功能扩展，一般需要要服务端另行安装，作用就是缓存数据的.
如:某个投票页面，当要判断某个用户是否已经投了票，且在多少时间内不能再投票，时间过后才能再投第二票，这时就得用Memcache 这样类似的东西来缓存这个IP了，这样比读表要方便高效得多.
----------------------------------------------------------------------------------------------------------------------

28. autoFilter(&$parse)
功能：自动输入过滤。
参数:$parse:对象名
如：
$tsy = "select * from 'b'";
echo autoFilter(&$tsy);   结果输出：select * from \'b\'
--------------------------------------------------------------------------------------------------------------------

29.array_combine($key,$value)
功能：数通过合并两个数组来创建一个新数组，其中的一个数组是键名，另一个数组的值为键值。
注意：两个参数必须有相同数目的元素。
参数：$key:键名数组；$value:键值数组。
如：
$arr1 = array('a','b');
$arr3 = array('dog','pig');
$result = array_combine($arr1,$arr3);
Print_r($result['b']);    结果输出：pig
----------------------------------------------------------------------------------------------------------------------

30. safeHTML($html)
功能：去掉所有HTML标记,除 <strong>, <em>, <u> and <a>。
参数：$html:html代码段。
如：
$strs = "<label><a href = ''>链接</a>
    				<span >用户ID:</span>
    				<span ><input name = 'userid' type = 'text' /></span>
				</label>";
echo safeHTML($strs);       结果输出：链接 用户ID:
----------------------------------------------------------------------------------------------------------------------

31. safeSQL($string)
功能：SQL字符串入库过滤。
如：
$sql = "select * from student where name = 'xiaoming'";
echo safeSQL($sql);         结果输出：select * from student where name = \'xiaoming\'
---------------------------------------------------------------------------------------------------------------------

32.safeSTR($string)
功能：字符串手动过滤，清理空格字符，字符转义，将换行符转化为<br />，过滤文本中的HTML标签，将文本中的内容转换为HTML实体。
如：
$s1 = "sdfd   dfdsfdsd我 '' \\     dfdfdsfd <html><body><input name = 'userid' type = 'text' /><a href = ''>测试</a></body></html>" ;
echo safeSTR($s1);          结果输出：sdfd dfdsfdsd我 \'\' dfdfdsfd 测试
--------------------------------------------------------------------------------------------------------------------

33. safeVALUE($string)
功能：初步安全过滤。
如：
$s1 = "sdfd   dfdsfdsd我 '' \\     dfdfdsfd <html><body><input name = 'userid' type = 'text' /><a href = ''>测试</a></body></html>" ;
echo safeVaLUE($s1);          结果输出：  
----------------------------------------------------------------------------------------------------------------------

34. quotes($content)
功能：字符串入库处理，对特殊字符进行转义。
----------------------------------------------------------------------------------------------------------------------

35.unquotes($content)
功能：字符串出库处理，quotes的逆函数。
----------------------------------------------------------------------------------------------------------------------

36. mk_dir($path, $mode = 0777)
功能：创建文件夹。
参数：$path:路径；$mode:权限值。
如： mk_dir("../Test", $mode = 0777);  结果：创建一个Test文件夹在xywz目录下。
----------------------------------------------------------------------------------------------------------------------

37. mk_file($filepath, $content = '', $mode = 0777)
功能：创建文件。
参数：$filepath:文件路径；$content:文件内容；$mode:权限值。
如：mk_file("../Test/a.txt", 'aa', $mode = 0777);结果：在xywz/Test目录下创建了a.txt文件。
----------------------------------------------------------------------------------------------------------------------

38. empty_dir($directory)
功能：判断目录是否存在。
如：$a = empty_dir("../Test");  echo $a;  结果输出：1 也就是ture,因为我现在xywz目录下有这个Test文件夹。
----------------------------------------------------------------------------------------------------------------------

39. remove_dir($dirName)
功能：删除目录及其下所有文件
参数：$dirName:目录
如：remove_dir("../Test"); 结果：删除Test目录及所有下面的文件。
----------------------------------------------------------------------------------------------------------------------

40. gourl($url, $msg = '', $iframe = false)
功能：带提示信息转向页面。
参数：$url:要转向的页面路径，$msg:提示信息；$iframe: 需要刷新的子窗口名.$iframe = false表示不需要刷新子窗口。
如：gourl('http://www.baidu.com', 'hello'); 结果：弹出hello提示框，然后跳转到www.baidu.com.
---------------------------------------------------------------------------------------------------------------------

41. open($url)
功能：跳转到新页面。
如：open('http://www.baidu.com'); 结果：在另一个新窗口打开www.baidu.com.
---------------------------------------------------------------------------------------------------------------------

42. confirm($msg, $url_1, $url_2)
功能：弹出是否提示框，选择是跳转到$url_1,选择否跳转到$url_2.
参数：$msg:提示消息；$url_1,$url_2两个不同的URL.
如：confirm("大家好吗？", 'http://www.baidu.com', 'http://www.kugou.com');
结果：提示“大家好吗？”如果选择确定就跳转到http://www.baidu.com,取消就是跳转到http://www.kugou.com。
----------------------------------------------------------------------------------------------------------------------

43. gourltop($url, $msg = null)
功能：一般是在有iframe的页面用的，意思是回到最顶一层的iframe页面去,弹出消息并跳转到目标页面$url的顶层,这个顶层也就是放iframe的页面。
----------------------------------------------------------------------------------------------------------------------

44. goback($msg)
功能：弹出信息并后退到前一页面。
如：goback ('http://www.baidu.com', '欢迎来到百度空间'); 
----------------------------------------------------------------------------------------------------------------------

45．xmlToArray($xml, $section = '')
功能：XML转成数组。
参数：$xml:xml内容也可以是xml文件路径，$section：节点名称
如：
$xmls = "<?xml version='1.0' encoding='utf-8'?>
<root>
<item id='0'><![CDATA[aaaaaaaa]]></item>
<item id='1'><![CDATA[bbbbbbb]]></item>
<item id='2'><![CDATA[ccccccccccc]]></item>
</root>";
$arrs = xmlToArray($xmls);
dump($arrs);
输出：
array(1) {
  ["item"] => array(3) {
    [0] => array(1) {
      ["@attributes"] => array(1) {
        ["id"] => string(1) "0"
      }
    }
    [1] => array(1) {
      ["@attributes"] => array(1) {
        ["id"] => string(1) "1"
      }
    }
    [2] => array(1) {
      ["@attributes"] => array(1) {
        ["id"] => string(1) "2"
      }
    }
  }
}
----------------------------------------------------------------------------------------------------------------------

46. arrayToXml($data, $encoding = 'utf-8', $root = 'root', $st = 'default')
功能：数组转成XML.
参数：$data:数组；$encoding: xml编码 utf-8 || gb2312;$root: 根节点名称;$st:格式，默认是default。
如：
$arrtoxml = array('aaaaaaaa'=>'value1', 'bbbbbbb'=>'value2', 'ccccccccccc'=>'value3');
$xmlss = arrayToXml($arrtoxml, 'utf-8', 'root');
dump($xmlss);
结果：
string(173) "<?xml version = "1.0" encoding = "utf-8" ?><root><aaaaaaaa><![CDATA[value1]]></aaaaaaaa><bbbbbbb><![CDATA[value2]]></bbbbbbb><ccccccccccc><![CDATA[value3]]></ccccccccccc></root>"
----------------------------------------------------------------------------------------------------------------------

47. dataByOther($data)，dataByDefault($data)
功能：实现arrayToXml()的两种不同方法。
----------------------------------------------------------------------------------------------------------------------

48. object_toArray($object)
功能：object 转成数组。
参数：$object:数组或其他对象。
如：
class Student
{
    public $id = 1;	
    public $name = 'lucy';
    public $sex = '女';
}
$stu = new Student();
dump(object_toArray($stu));
输出：
array(3) {
  ["id"] => int(1)
  ["name"] => string(4) "lucy"
  ["sex"] => string(3) "女"
}
----------------------------------------------------------------------------------------------------------------------

59. getClientIp()
功能：取客户端IP。
----------------------------------------------------------------------------------------------------------------------

50. string_toArray($str, $sp = ',', $mode = 0)
功能：字符串转成数组。
参数：$str:字符串；$sp:字符串分隔符；$mode:数组组合方式。
如：
($mode = 0的情况下) $sss = "a,bcdef";
dump(string_toArray($sss, ',', 0));  
输出：
array(1) {
  ["a"] => string(5) "bcdef"
}

($mode >= 1的情况下) $sss = "a,bcdef";
dump(string_toArray($sss, ',', 1);  
输出：
array(1) {
  ["bcdef "] => string(5) "a"
}
----------------------------------------------------------------------------------------------------------------------

51. array_toString($arr)
功能：数组转换为字符串。
如：
$obj = array('笑傲江湖', '龙啸九天');
echo array_toString($obj);  结果输出：笑傲江湖,龙啸九天
----------------------------------------------------------------------------------------------------------------------

52. array_2toSingle($arr)
功能：二维数组转为单一数组。
如：
$abc  =  array('left'=>array('aa'=>'123', 'bb'=>'456'), 'right' =>array('one'=>'1', 'thd'=>'3'));
print_r(array_2toSingle($abc));    结果输出：Array ( [left] => 123,456 [right] => 1,3 )
----------------------------------------------------------------------------------------------------------------------

53. OBOutBuffer()
功能：缓存输出处理函数。
----------------------------------------------------------------------------------------------------------------------

54. boolVal($var)
功能：bool值处理函数。
参数：$var 变量 false:
'false', 'False', 'FALSE', 'no', 'No', 'n', 'N', '0', 'off', 'Off', 'OFF', 'NULL', 'null', false, 0, null, NULL;
True: 'true', 'True', 'TRUE', 'yes', 'Yes', 'y', 'Y', '1', 'on', 'On', 'ON', true, 1
如：
dump(boolVal('no'));     输出：bool(false) 
dump(boolVal('1'));      输出：bool(true)
----------------------------------------------------------------------------------------------------------------------

55. filePutTxt($file = '', $conts = '')
功能：写TXT文件
参数：$file：txt文件的绝对路径，$conts：内容。
如：filePutTxt(ROOT."/a.txt", 'bbbbbbbbbbbbb'); 结果：在xywz根目录下生产a.txt文件。
----------------------------------------------------------------------------------------------------------------------

56. referer($dec_url = array())
功能：判断页面来路是否为授权来路。
参数：$dec_url：授权页面来路
----------------------------------------------------------------------------------------------------------------------

57. toSemiangle($str)
功能：转成半角字符
如：echo toSemiangle('ａｂｃｄ'); 结果输出：abcd
----------------------------------------------------------------------------------------------------------------------

58. replaceKeywords($_keys_array, $content)
功能：指定内容内关键字替换
参数：$_keys_array: 键字映射表;$content:内容。
如：
$key  =  array('来'=>'aaa');
dump($key);
dump('否极泰来');
dump(replaceKeywords($key, '否极泰来')); 

结果输出：
array(1) {
  ["来"] => string(3) "aaa"
}
string(12) "否极泰来"
string(12) "否极泰aaa"
----------------------------------------------------------------------------------------------------------------------